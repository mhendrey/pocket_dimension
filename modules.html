

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pocket_dimension.random_projection &mdash; Pocket Dimension 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=938c9ccc"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="License" href="license.html" />
    <link rel="prev" title="Pocket Dimension" href="pocket_dimension.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Pocket Dimension
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="pocket_dimension.html">Pocket Dimension</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pocket_dimension.html#the-basics">The Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="pocket_dimension.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="pocket_dimension.html#the-details">The Details</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">pocket_dimension.random_projection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pocket_dimension.random_projection.JustInTimeRandomProjection"><code class="docutils literal notranslate"><span class="pre">JustInTimeRandomProjection</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.random_projection.JustInTimeRandomProjection.n_components_"><code class="docutils literal notranslate"><span class="pre">JustInTimeRandomProjection.n_components_</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.random_projection.JustInTimeRandomProjection.fit"><code class="docutils literal notranslate"><span class="pre">JustInTimeRandomProjection.fit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.random_projection.JustInTimeRandomProjection.transform"><code class="docutils literal notranslate"><span class="pre">JustInTimeRandomProjection.transform()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pocket_dimension.random_projection.distributional_johnson_lindenstrauss_optimal_delta"><code class="docutils literal notranslate"><span class="pre">distributional_johnson_lindenstrauss_optimal_delta()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pocket_dimension.random_projection.random_projection"><code class="docutils literal notranslate"><span class="pre">random_projection()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pocket_dimension.random_projection.random_sparse_vectors"><code class="docutils literal notranslate"><span class="pre">random_sparse_vectors()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pocket_dimension.random_projection.splitmix64"><code class="docutils literal notranslate"><span class="pre">splitmix64()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#module-pocket_dimension.vectorizer">pocket_dimension.vectorizer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pocket_dimension.vectorizer.TFIDFVectorizer"><code class="docutils literal notranslate"><span class="pre">TFIDFVectorizer</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer"><code class="docutils literal notranslate"><span class="pre">TFVectorizer</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer.d"><code class="docutils literal notranslate"><span class="pre">TFVectorizer.d</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer.hash_dim"><code class="docutils literal notranslate"><span class="pre">TFVectorizer.hash_dim</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer.hasher"><code class="docutils literal notranslate"><span class="pre">TFVectorizer.hasher</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer.jit_rp"><code class="docutils literal notranslate"><span class="pre">TFVectorizer.jit_rp</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer.temperature"><code class="docutils literal notranslate"><span class="pre">TFVectorizer.temperature</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer.min_n_features"><code class="docutils literal notranslate"><span class="pre">TFVectorizer.min_n_features</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer.min_n_observations"><code class="docutils literal notranslate"><span class="pre">TFVectorizer.min_n_observations</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer.cms"><code class="docutils literal notranslate"><span class="pre">TFVectorizer.cms</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer.minDF"><code class="docutils literal notranslate"><span class="pre">TFVectorizer.minDF</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer.maxDF"><code class="docutils literal notranslate"><span class="pre">TFVectorizer.maxDF</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer.filter"><code class="docutils literal notranslate"><span class="pre">TFVectorizer.filter</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer.filter_out"><code class="docutils literal notranslate"><span class="pre">TFVectorizer.filter_out</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer.filter_reweight_features"><code class="docutils literal notranslate"><span class="pre">TFVectorizer.filter_reweight_features()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer.yield_record"><code class="docutils literal notranslate"><span class="pre">TFVectorizer.yield_record()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pocket_dimension.vectorizer.numba_idf"><code class="docutils literal notranslate"><span class="pre">numba_idf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#module-tests.test_pocket_dimension">tests.test_pocket_dimension</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tests.test_pocket_dimension.sparse_distance_squared"><code class="docutils literal notranslate"><span class="pre">sparse_distance_squared()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tests.test_pocket_dimension.test_distributional_johnson_lindenstrauss"><code class="docutils literal notranslate"><span class="pre">test_distributional_johnson_lindenstrauss()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tests.test_pocket_dimension.test_johnson_lindenstrauss"><code class="docutils literal notranslate"><span class="pre">test_johnson_lindenstrauss()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tests.test_pocket_dimension.test_numba_idf"><code class="docutils literal notranslate"><span class="pre">test_numba_idf()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tests.test_pocket_dimension.test_tf"><code class="docutils literal notranslate"><span class="pre">test_tf()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tests.test_pocket_dimension.test_tf_cms"><code class="docutils literal notranslate"><span class="pre">test_tf_cms()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tests.test_pocket_dimension.test_tf_data_quality"><code class="docutils literal notranslate"><span class="pre">test_tf_data_quality()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tests.test_pocket_dimension.test_tf_filter"><code class="docutils literal notranslate"><span class="pre">test_tf_filter()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tests.test_pocket_dimension.test_tf_temp"><code class="docutils literal notranslate"><span class="pre">test_tf_temp()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tests.test_pocket_dimension.test_tfidf"><code class="docutils literal notranslate"><span class="pre">test_tfidf()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#tests.test_pocket_dimension.test_tfidf_data_quality"><code class="docutils literal notranslate"><span class="pre">test_tfidf_data_quality()</span></code></a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Admin</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a><ul>
<li class="toctree-l2"><a class="reference internal" href="license.html#license-requirements">License Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="license.html#license-notices">License notices</a></li>
<li class="toctree-l2"><a class="reference internal" href="license.html#copyright">Copyright</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="help.html">Help</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pocket Dimension</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">pocket_dimension.random_projection</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/modules.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="toctree-wrapper compound">
</div>
<section id="module-pocket_dimension.random_projection">
<span id="pocket-dimension-random-projection"></span><h1>pocket_dimension.random_projection<a class="headerlink" href="#module-pocket_dimension.random_projection" title="Link to this heading"></a></h1>
<p>Pocket Dimension provides a memory-efficient, dense, random projection of sparse vectors
and then applies this to Term Frequency (TF) and Term Frequency, Inverse Document
Frequency (TFIDF) data.</p>
<p>Copyright (C) 2022 Matthew Hendrey &amp; Brendan Murphy</p>
<p>This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with this program.  If not, see &lt;<a class="reference external" href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>&gt;.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pocket_dimension.random_projection.JustInTimeRandomProjection">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pocket_dimension.random_projection.</span></span><span class="sig-name descname"><span class="pre">JustInTimeRandomProjection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pocket_dimension/random_projection.html#JustInTimeRandomProjection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pocket_dimension.random_projection.JustInTimeRandomProjection" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseRandomProjection</span></code></p>
<p>Reduce the dimensionality of sparse vectors using a dense random projection matrix
in a memory-efficient way.</p>
<p>This is an alternative to scikit-learn.random_projection.SparseRandomProjection.
This implementation provides higher quality embedding and is constant in the amount
of RAM needed, irrespective of the sparse starting dimension. It achieves this by
not storing the projection matrix in memory, but instead generates only the needed
columns just-in-time for any given input vector. This makes the same as a
SparseRandomProjection when the density = 1.0.</p>
<p>The elements of the projection matrix, <span class="math notranslate nohighlight">\(\pm 1 / \sqrt{n\_components}\)</span>, are
generated as needed using a hashing function to provide a random choice of the
sign. This uses numba functions to enable faster computation and is parallelized
across the available cpus.</p>
<p>This allows you to utilize sparse starting dimension of 2**31 - 1 without any
issues. For large values of <code class="docutils literal notranslate"><span class="pre">n_components</span></code> transforming will also be faster
than SparseRandomProjection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_components</strong> (<em>int</em><em> or </em><em>'auto'</em><em>, </em><em>default = 'auto'</em>) – <p>Dimensionality of the target projection space. If not a multiple of 64, then
it will be rounded down to the nearest multiple of 64.</p>
<p>If ‘auto’, then it will pick a dimensionality that satisfies the
Johnson-Lindenstrauss Lemma based upon the <code class="docutils literal notranslate"><span class="pre">eps</span></code> parameter. The
dimensionality will then be rounded up to the nearest multiple of 64
to ensure you satisfy the conditions in the lemma.</p>
<p><strong>NOTE</strong> This can yield a very conservative estimate of the required
dimensionality.</p>
</p></li>
<li><p><strong>eps</strong> (<em>float</em><em>, </em><em>default = 0.1</em>) – Parameter to control the quality of the embedding according to the
Johnson-Lindenstrauss Lemma. This is used if <code class="docutils literal notranslate"><span class="pre">n_components</span></code> is ‘auto’.
This represents the error rate between distances in the sparse dimension
and the resulting lower embedding dimension. Smaller values of <code class="docutils literal notranslate"><span class="pre">eps</span></code>
give larger values of <code class="docutils literal notranslate"><span class="pre">n_components</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pocket_dimension.random_projection.JustInTimeRandomProjection.n_components_">
<span class="sig-name descname"><span class="pre">n_components_</span></span><a class="headerlink" href="#pocket_dimension.random_projection.JustInTimeRandomProjection.n_components_" title="Link to this definition"></a></dt>
<dd><p>Dimensionality of the embedding dimension. It will be a multiple of 64.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pocket_dimension.random_projection</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">JustInTimeRandomProjection</span><span class="p">,</span>
    <span class="n">random_sparse_vectors</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">n_components</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">sparse_dim</span> <span class="o">=</span> <span class="mi">1_073_741_824</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">100_000</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">random_sparse_vectors</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">sparse_dim</span><span class="o">=</span><span class="n">sparse_dim</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">transformer</span> <span class="o">=</span> <span class="n">JustInTimeRandomProjection</span><span class="p">(</span><span class="n">n_components</span><span class="p">)</span>
<span class="c1"># No need to fit if provide a value for n_components at initialization</span>
<span class="n">X_new</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X_new</span><span class="o">.</span><span class="n">shape</span>
<span class="c1"># (25, 64)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="pocket_dimension.random_projection.JustInTimeRandomProjection.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pocket_dimension/random_projection.html#JustInTimeRandomProjection.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pocket_dimension.random_projection.JustInTimeRandomProjection.fit" title="Link to this definition"></a></dt>
<dd><p>This is essential a no-op function since there is no need to generate a random
projection matrix. Instead, this is validating input data and if
<code class="docutils literal notranslate"><span class="pre">n_components</span></code> is ‘auto’, then it sets it according to the
Johnson-Lindenstrauss lemma limits based upon X.shape[1] and <code class="docutils literal notranslate"><span class="pre">eps</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>csr_matrix</em>) – Only the shape is used to find the optimal value of <code class="docutils literal notranslate"><span class="pre">n_components</span></code> to
satisfy Johnson-Lindenstrauss lemma theoretical guarantees.</p></li>
<li><p><strong>y</strong> (<em>Ignored</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – JustInTimeRandomProjection class instance</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pocket_dimension.random_projection.JustInTimeRandomProjection.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">csr_matrix</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/pocket_dimension/random_projection.html#JustInTimeRandomProjection.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pocket_dimension.random_projection.JustInTimeRandomProjection.transform" title="Link to this definition"></a></dt>
<dd><p>Project the data using the just-in-time generated dense random projection
matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>csr_matrix</em>) – The input data to project into a smaller dimensional space. Shape is
(n_samples, sparse_dim)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Projected data of shape (n_samples, n_components)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pocket_dimension.random_projection.distributional_johnson_lindenstrauss_optimal_delta">
<span class="sig-prename descclassname"><span class="pre">pocket_dimension.random_projection.</span></span><span class="sig-name descname"><span class="pre">distributional_johnson_lindenstrauss_optimal_delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sparse_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/pocket_dimension/random_projection.html#distributional_johnson_lindenstrauss_optimal_delta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pocket_dimension.random_projection.distributional_johnson_lindenstrauss_optimal_delta" title="Link to this definition"></a></dt>
<dd><p>Algorithm to find the optimal failure rate, delta, for a given <code class="docutils literal notranslate"><span class="pre">eps</span></code> (error rate),
<code class="docutils literal notranslate"><span class="pre">sparse_dim</span></code>, and <code class="docutils literal notranslate"><span class="pre">n_components</span></code> (embedding dimension) for the Distributional
Johnson-Lindenstrauss Lemma which is a different formulation of the problem.
Taken from</p>
<p>M. Skorski. <em>Johnson-Lindenstrauss Transforms with Best Confidence</em>,
Proceedings of Machine Learning Research <strong>134</strong>, 1 (2021)</p>
<p>which can be found at <a class="reference external" href="http://proceedings.mlr.press/v134/skorski21a/skorski21a.pdf">http://proceedings.mlr.press/v134/skorski21a/skorski21a.pdf</a></p>
<p>If <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is the random projection matrix, then <span class="math notranslate nohighlight">\(\delta\)</span> is the
probability of exceeding error limits given by</p>
<div class="math notranslate nohighlight">
\[\delta = \mathbb{P} \lbrack \vert \Vert \mathbf{A}x \Vert^2_2 -
\Vert x \Vert^2_2 \vert &gt; \epsilon \Vert x \Vert^2_2 {\rbrack}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sparse_dim</strong> (<em>int</em>) – Original dimension of the data</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – Embedding dimension</p></li>
<li><p><strong>eps</strong> (<em>float</em>) – Error rate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>delta</strong> – The best probability of failure that you can expect</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pocket_dimension.random_projection.random_projection">
<span class="sig-prename descclassname"><span class="pre">pocket_dimension.random_projection.</span></span><span class="sig-name descname"><span class="pre">random_projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indptr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pocket_dimension/random_projection.html#random_projection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pocket_dimension.random_projection.random_projection" title="Link to this definition"></a></dt>
<dd><p>Randomly project a sparse matrix (standard CSR representation) to a dense vectors
by effectively multiplying by a random matrix whose elements are
<span class="math notranslate nohighlight">\(\pm 1 / \sqrt{d}\)</span>. The projection matrix is never stored in memory. Instead
the elements are generated as needed using splitmix64().
<strong>Note</strong> Embedding dimension, <cite>d</cite>, is rounded to a multiple of 64 since we generate
random bits in batches of 64 in order to utilize bit manipulation to speed things
up.</p>
<p>The column indices for row i are stored in indices[indptr[i]:indptr[i+1]] and the
corresponding values are stored in data[indptr[i]:indptr[i+1]].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.ndarray</em><em>, </em><em>shape=</em><em>(</em><em>nnz</em><em>,</em><em>)</em><em>, </em><em>dtype=float32</em>) – The values of the nonzero elements in the sparse csr_matrix where nnz = number
of nonzero elements</p></li>
<li><p><strong>indices</strong> (<em>np.ndarray</em><em>, </em><em>shape=</em><em>(</em><em>nnz</em><em>,</em><em>)</em><em>, </em><em>dtype=int64</em>) – The column indices of the nonzero elements in the sparse csr_matrix</p></li>
<li><p><strong>indptr</strong> (<em>np.ndarray</em><em>, </em><em>shape=</em><em>(</em><em>n_rows+1</em><em>,</em><em>)</em><em>, </em><em>dtype=int64</em>) – Pointers into <cite>data</cite> and <cite>indices</cite> to indicate where the rows start and stop.
If you have just a single record, then indptr=[0, len(data)]</p></li>
<li><p><strong>d</strong> (<em>int</em>) – Embedding dimension of dense vectors.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>X</strong> – Dense 2-d array containing the randomly projected dense vectors for each row of
the input sparse matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray, shape=(n_rows, d), dtype=float32</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pocket_dimension.random_projection.random_sparse_vectors">
<span class="sig-prename descclassname"><span class="pre">pocket_dimension.random_projection.</span></span><span class="sig-name descname"><span class="pre">random_sparse_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2147483647</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Generator</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">csr_matrix</span></span></span><a class="reference internal" href="_modules/pocket_dimension/random_projection.html#random_sparse_vectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pocket_dimension.random_projection.random_sparse_vectors" title="Link to this definition"></a></dt>
<dd><p>Randomly generate sparse vectors for testing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of sparse vectors to create</p></li>
<li><p><strong>sparse_dim</strong> (<em>int</em><em>, </em><em>default = 2**31 - 1</em>) – Dimensionality of the sparse vectors.</p></li>
<li><p><strong>min_n_features</strong> (<em>int</em><em>, </em><em>default = 10</em>) – Minimum number of features any given sparse vector may have</p></li>
<li><p><strong>max_n_features</strong> (<em>int</em><em>, </em><em>default = 100</em>) – Maximum number of features any given sparse vector may have</p></li>
<li><p><strong>normalize</strong> (<em>bool</em><em>, </em><em>default = False</em>) – If true, normalizes the sparse vectors to all have unit length.</p></li>
<li><p><strong>rng</strong> (<em>np.random.Generator</em><em>, </em><em>default = None</em>) – A numpy random generator. If None, then one is created</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Shape is (n_samples, sparse_dim)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>csr_matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pocket_dimension.random_projection.splitmix64">
<span class="sig-prename descclassname"><span class="pre">pocket_dimension.random_projection.</span></span><span class="sig-name descname"><span class="pre">splitmix64</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pocket_dimension/random_projection.html#splitmix64"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pocket_dimension.random_projection.splitmix64" title="Link to this definition"></a></dt>
<dd><p>Fast, simple function for taking an integer and returning a random number. Function
used in Java random number generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index</strong> (<em>uint64</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>uint64</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-pocket_dimension.vectorizer">
<span id="pocket-dimension-vectorizer"></span><h1>pocket_dimension.vectorizer<a class="headerlink" href="#module-pocket_dimension.vectorizer" title="Link to this heading"></a></h1>
<p>Pocket Dimension provides a memory-efficient, dense, random projection of sparse vectors
and then applies this to Term Frequency (TF) and Term Frequency, Inverse Document
Frequency (TFIDF) data.</p>
<p>Copyright (C) 2022 Matthew Hendrey &amp; Brendan Murphy</p>
<p>This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with this program.  If not, see &lt;<a class="reference external" href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>&gt;.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFIDFVectorizer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pocket_dimension.vectorizer.</span></span><span class="sig-name descname"><span class="pre">TFIDFVectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cms_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">hash_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2147483647</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minDF</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxDF</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4294967295</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n_observations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pocket_dimension/vectorizer.html#TFIDFVectorizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pocket_dimension.vectorizer.TFIDFVectorizer" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#pocket_dimension.vectorizer.TFVectorizer" title="pocket_dimension.vectorizer.TFVectorizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">TFVectorizer</span></code></a></p>
<p>Randomly project records by first applying a high-dimensional feature hasher
to create a sparse vector representation of the tf-idf and then applying the
random projection to a dense embedding dimension.</p>
<div class="math notranslate nohighlight">
\[tfidf = c^{1/temp} \log{10}(n\_records / (doc\_freq + 1))\]</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFVectorizer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pocket_dimension.vectorizer.</span></span><span class="sig-name descname"><span class="pre">TFVectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">cms_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hash_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2147483647</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minDF</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxDF</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4294967295</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n_observations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pocket_dimension/vectorizer.html#TFVectorizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pocket_dimension.vectorizer.TFVectorizer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Calculate a Term-Frequency vector representation by first using sklearn’s
FeatureHasher to create a high-dimensional, sparse vector representation.
Then apply the JustInTimeRandomProjection to return a lower-dimensional
dense vector representation. The resulting vectors will be normalized to unit
length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>int</em>) – Dimension of the dense vector output. Rounded down to nearest multiple of 64 if
not already</p></li>
<li><p><strong>cms_file</strong> (<em>str</em><em> | </em><em>Path</em><em>, </em><em>optional</em>) – Filename of a saved count-min sketch to use for filtering out features
whose document frequency falls outside of [minDF, maxDF]. Default is None</p></li>
<li><p><strong>hash_dim</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of dimensions that features get hashed to for the sparse vector
representation. Should have <cite>hash_dim &gt;&gt; d</cite>. Default is the largest
possible 2**31 - 1 (~2 billion) for sklearn’s FeatureHasher</p></li>
<li><p><strong>minDF</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum document frequency (number of records with this feature) a feature
must have to be included in the embedding. Default is 1</p></li>
<li><p><strong>maxDF</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum document frequency (number of records with this feature) a feature
can have to be included in the embedding. Default is 2**32 - 1.</p></li>
<li><p><strong>temperature</strong> (<em>float</em><em>, </em><em>optional</em>) – Option to reshape the term frequency vector by raising each count to
(1/temperature). Using a value above 1.0 flattens the values relative to
each other. Using a value below 1.0 sharpens the contrast of values
relative to each other.</p></li>
<li><p><strong>min_n_features</strong> (<em>int</em>) – Must have at least this many features in order to create a vector. Useful as a
data quality check. Default is 1</p></li>
<li><p><strong>min_n_observations</strong> (<em>int</em>) – Must have at least this many observations in order to create a vector. Useful as
a data quality check. This is the sum of counts over the different features for
a given item. Default is 1</p></li>
<li><p><strong>filter</strong> (<em>pybloomfilter3</em><em>, </em><em>option</em>) – Bloom filter to use for filtering features before creating sparse vectors.
Default is None</p></li>
<li><p><strong>filter_out</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, then remove features that are in the filter before making the
sparse vector. If False, then only use features that are in the filter in
the sparse vector. Not used if <cite>filter</cite> is None. Default is True.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFVectorizer.d">
<span class="sig-name descname"><span class="pre">d</span></span><a class="headerlink" href="#pocket_dimension.vectorizer.TFVectorizer.d" title="Link to this definition"></a></dt>
<dd><p>Embedding dimension of the dense vector. Must be multiple of 64</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFVectorizer.hash_dim">
<span class="sig-name descname"><span class="pre">hash_dim</span></span><a class="headerlink" href="#pocket_dimension.vectorizer.TFVectorizer.hash_dim" title="Link to this definition"></a></dt>
<dd><p>Dimension of the sparse vector. Must be &lt;= 2**31-1</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFVectorizer.hasher">
<span class="sig-name descname"><span class="pre">hasher</span></span><a class="headerlink" href="#pocket_dimension.vectorizer.TFVectorizer.hasher" title="Link to this definition"></a></dt>
<dd><p>Hashes input features (bytes) to integer representing corresponding dimension</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sklearn.feature_extraction.FeatureHasher</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFVectorizer.jit_rp">
<span class="sig-name descname"><span class="pre">jit_rp</span></span><a class="headerlink" href="#pocket_dimension.vectorizer.TFVectorizer.jit_rp" title="Link to this definition"></a></dt>
<dd><p>Efficiently projects high-dimensional sparse vectors down to lower dimensional
dense vectors</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#pocket_dimension.random_projection.JustInTimeRandomProjection" title="pocket_dimension.random_projection.JustInTimeRandomProjection">JustInTimeRandomProjection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFVectorizer.temperature">
<span class="sig-name descname"><span class="pre">temperature</span></span><a class="headerlink" href="#pocket_dimension.vectorizer.TFVectorizer.temperature" title="Link to this definition"></a></dt>
<dd><p>Exponential scale raw counts by 1 / temperature when making TF vector</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFVectorizer.min_n_features">
<span class="sig-name descname"><span class="pre">min_n_features</span></span><a class="headerlink" href="#pocket_dimension.vectorizer.TFVectorizer.min_n_features" title="Link to this definition"></a></dt>
<dd><p>Must have at least this many features in order to create a vector</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFVectorizer.min_n_observations">
<span class="sig-name descname"><span class="pre">min_n_observations</span></span><a class="headerlink" href="#pocket_dimension.vectorizer.TFVectorizer.min_n_observations" title="Link to this definition"></a></dt>
<dd><p>Must have at least this many observations in order to create a vector</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFVectorizer.cms">
<span class="sig-name descname"><span class="pre">cms</span></span><a class="headerlink" href="#pocket_dimension.vectorizer.TFVectorizer.cms" title="Link to this definition"></a></dt>
<dd><p>A count-min sketch that stores document frequency info</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sketchnu.CountMinLinear | sketchnu.CountMinLog16 | sketchnu.CountMinLog8</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFVectorizer.minDF">
<span class="sig-name descname"><span class="pre">minDF</span></span><a class="headerlink" href="#pocket_dimension.vectorizer.TFVectorizer.minDF" title="Link to this definition"></a></dt>
<dd><p>Minimum document frequency a feature must have to be included in the vector</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFVectorizer.maxDF">
<span class="sig-name descname"><span class="pre">maxDF</span></span><a class="headerlink" href="#pocket_dimension.vectorizer.TFVectorizer.maxDF" title="Link to this definition"></a></dt>
<dd><p>Maximum document frequency a feature can have to be included in the vector</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFVectorizer.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><a class="headerlink" href="#pocket_dimension.vectorizer.TFVectorizer.filter" title="Link to this definition"></a></dt>
<dd><p>BloomFilter containing features to be filtered</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pybloomfilter.BloomFilter</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFVectorizer.filter_out">
<span class="sig-name descname"><span class="pre">filter_out</span></span><a class="headerlink" href="#pocket_dimension.vectorizer.TFVectorizer.filter_out" title="Link to this definition"></a></dt>
<dd><p>If True, then any feature found in the <cite>filter</cite> will be excluded from the
vector. If False, then only features found in the <cite>filter</cite> are included in
vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFVectorizer.filter_reweight_features">
<span class="sig-name descname"><span class="pre">filter_reweight_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">counts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/pocket_dimension/vectorizer.html#TFVectorizer.filter_reweight_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pocket_dimension.vectorizer.TFVectorizer.filter_reweight_features" title="Link to this definition"></a></dt>
<dd><p>Filter the features accordingly and reweight the associated counts. The counts
are scaled by raising them to <span class="math notranslate nohighlight">\(1/temperature\)</span> and then multiplied by the
<code class="docutils literal notranslate"><span class="pre">idf</span></code> value. For TFVectorizer <span class="math notranslate nohighlight">\(idf=1.0\)</span>.</p>
<p>Features will be filtered out if their document frequency is not within
[<code class="docutils literal notranslate"><span class="pre">minDF</span></code>, <code class="docutils literal notranslate"><span class="pre">maxDF</span></code>] and if a <code class="docutils literal notranslate"><span class="pre">filter</span></code> is provided during initialization.
Only those features that pass the filters will contribute to the final vector.</p>
<p>After filtering, a final check is done to ensure that there are at least
<code class="docutils literal notranslate"><span class="pre">min_n_features</span></code> features remaining and that there are at least
<code class="docutils literal notranslate"><span class="pre">min_n_observations</span></code> observations of those features. Otherwise an empty list
is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> (<em>List</em><em>[</em><em>bytes</em><em>]</em>) – List of the individual features. These will be hashed by the FeatureHasher
to turn into a sparse vector representation</p></li>
<li><p><strong>counts</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – Number of times that feature is present in a given record.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>List[Tuple[bytes, float]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.TFVectorizer.yield_record">
<span class="sig-name descname"><span class="pre">yield_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">records</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pocket_dimension/vectorizer.html#TFVectorizer.yield_record"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pocket_dimension.vectorizer.TFVectorizer.yield_record" title="Link to this definition"></a></dt>
<dd><p>Yields a list of an individual record’s (features, values) where the values are
the counts after reweighting them by <code class="docutils literal notranslate"><span class="pre">temperature</span></code> and/or <code class="docutils literal notranslate"><span class="pre">idf</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>records</strong> (<em>Iterable</em><em>[</em><em>Dict</em><em>]</em>) – An iterable of records where each records is a dict of
{“id”: str, “features”: List[bytes], “counts”: List[int]}</p></li>
<li><p><strong>ids</strong> (<em>List</em>) – Pass in an empty list which will be returned with corresponding ids from
the <cite>records</cite> passed in</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>List[Tuple[bytes, float]]</em> – Of the appropriate individual (feature, value) for a given record</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pocket_dimension.vectorizer.numba_idf">
<span class="sig-prename descclassname"><span class="pre">pocket_dimension.vectorizer.</span></span><span class="sig-name descname"><span class="pre">numba_idf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">doc_freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_records</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pocket_dimension/vectorizer.html#numba_idf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pocket_dimension.vectorizer.numba_idf" title="Link to this definition"></a></dt>
<dd><p>Numba function to calculate the idf value for a <code class="docutils literal notranslate"><span class="pre">doc_freq</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>doc_freq</strong> (<em>float32</em>) – Number of records that contain this particular feature.</p></li>
<li><p><strong>n_records</strong> (<em>float32</em>) – Total number of records in the data set.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float32</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-tests.test_pocket_dimension">
<span id="tests-test-pocket-dimension"></span><h1>tests.test_pocket_dimension<a class="headerlink" href="#module-tests.test_pocket_dimension" title="Link to this heading"></a></h1>
<p>Pocket Dimension provides a memory-efficient, dense, random projection of sparse vectors
and then applies this to Term Frequency (TF) and Term Frequency, Inverse Document
Frequency (TFIDF) data.</p>
<p>Copyright (C) 2022 Matthew Hendrey &amp; Brendan Murphy</p>
<p>This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with this program.  If not, see &lt;<a class="reference external" href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>&gt;.</p>
<dl class="py function">
<dt class="sig sig-object py" id="tests.test_pocket_dimension.sparse_distance_squared">
<span class="sig-prename descclassname"><span class="pre">tests.test_pocket_dimension.</span></span><span class="sig-name descname"><span class="pre">sparse_distance_squared</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">csr_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">csr_matrix</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/tests/test_pocket_dimension.html#sparse_distance_squared"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tests.test_pocket_dimension.sparse_distance_squared" title="Link to this definition"></a></dt>
<dd><p>Calculate the distance between two sparse vectors</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_pocket_dimension.test_distributional_johnson_lindenstrauss">
<span class="sig-prename descclassname"><span class="pre">tests.test_pocket_dimension.</span></span><span class="sig-name descname"><span class="pre">test_distributional_johnson_lindenstrauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_pad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tests/test_pocket_dimension.html#test_distributional_johnson_lindenstrauss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tests.test_pocket_dimension.test_distributional_johnson_lindenstrauss" title="Link to this definition"></a></dt>
<dd><p>Test the statistical guarantees of the Distributional Johnson-Lindenstrauss Lemma
using a method for finding the best possible delta (failure rate) for a given
epsilon (error rate) of the difference of the L2 norm between vectors in the
original dimension (x) and the lower embedding dimension (Ax) described in</p>
<p>M. Skorski. <em>Johnson-Lindenstrauss Transforms with Best Confidence</em>,
Proceedings of Machine Learning Research <strong>134</strong>, 1 (2021)
<a class="reference external" href="http://proceedings.mlr.press/v134/skorski21a/skorski21a.pdf">http://proceedings.mlr.press/v134/skorski21a/skorski21a.pdf</a></p>
<p>This paper provides the optimal possible error probability</p>
<dl class="simple">
<dt>delta(sparse_dim, embed_dim, eps) =</dt><dd><p>P[abs(|Ax|**2 - |x|**2) &gt; eps * |x|**2]</p>
</dd>
</dl>
<p>given the best possible matrix A and the worst possible data x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of data points. Default is 1,000</p></li>
<li><p><strong>min_n_features</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum number of features any given vector may have. Default is 5</p></li>
<li><p><strong>max_n_features</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of features any given vector may have. Default is 100</p></li>
<li><p><strong>eps</strong> (<em>float</em><em>, </em><em>optional</em>) – Error rate. Default is 0.1</p></li>
<li><p><strong>delta_pad</strong> (<em>float</em><em>, </em><em>optional</em>) – Amount by which we pad the calculated best delta value. This is done to reduce
the probability of failure given the vagaries of running statistical tests.
Default is 0.01</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_pocket_dimension.test_johnson_lindenstrauss">
<span class="sig-prename descclassname"><span class="pre">tests.test_pocket_dimension.</span></span><span class="sig-name descname"><span class="pre">test_johnson_lindenstrauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_n_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tests/test_pocket_dimension.html#test_johnson_lindenstrauss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tests.test_pocket_dimension.test_johnson_lindenstrauss" title="Link to this definition"></a></dt>
<dd><p>Test the the Johnson-Lindenstrauss Lemma holds between the sparse vectors and the
randomly projected dense vectors. This uses the results found in</p>
<p><a class="reference external" href="https://cs.stanford.edu/people/mmahoney/cs369m/Lectures/lecture1.pdf">https://cs.stanford.edu/people/mmahoney/cs369m/Lectures/lecture1.pdf</a></p>
<p>This checkes that the ratio of the distance between two vectors in the embedding
to the distance between the original sparse vectors is between (1-eps) and (1+eps).
The embedding dimension is determined by the requested error rate, eps.</p>
<p>d = 24 * log(n) / (3 * eps**2 - 2 * eps ** 3)</p>
<p>where n is the number of vectors.  This does the full n(n-1)/2 comparisions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of sparse vectors to randomly generate. Default is 40</p></li>
<li><p><strong>min_n_features</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum number of features any given sparse vector may have. Default is 5</p></li>
<li><p><strong>max_n_features</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of features any given sparse vector may have. Default is 100</p></li>
<li><p><strong>eps</strong> (<em>float</em><em>, </em><em>optional</em>) – Desired error rate. Default is 0.05</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_pocket_dimension.test_numba_idf">
<span class="sig-prename descclassname"><span class="pre">tests.test_pocket_dimension.</span></span><span class="sig-name descname"><span class="pre">test_numba_idf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tests/test_pocket_dimension.html#test_numba_idf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tests.test_pocket_dimension.test_numba_idf" title="Link to this definition"></a></dt>
<dd><p>Test that the numba function numba_idf works as expected</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_pocket_dimension.test_tf">
<span class="sig-prename descclassname"><span class="pre">tests.test_pocket_dimension.</span></span><span class="sig-name descname"><span class="pre">test_tf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tests/test_pocket_dimension.html#test_tf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tests.test_pocket_dimension.test_tf" title="Link to this definition"></a></dt>
<dd><p>Basic test that things look right.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d</strong> (<em>int</em><em>, </em><em>optional</em>) – Embedding dimension. Default is 64</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_pocket_dimension.test_tf_cms">
<span class="sig-prename descclassname"><span class="pre">tests.test_pocket_dimension.</span></span><span class="sig-name descname"><span class="pre">test_tf_cms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tmp_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tests/test_pocket_dimension.html#test_tf_cms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tests.test_pocket_dimension.test_tf_cms" title="Link to this definition"></a></dt>
<dd><p>Test that using a count-min sketch for filtering works properly</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_pocket_dimension.test_tf_data_quality">
<span class="sig-prename descclassname"><span class="pre">tests.test_pocket_dimension.</span></span><span class="sig-name descname"><span class="pre">test_tf_data_quality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tests/test_pocket_dimension.html#test_tf_data_quality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tests.test_pocket_dimension.test_tf_data_quality" title="Link to this definition"></a></dt>
<dd><p>Test that records without minimium data quality (min_n_features &amp;
min_n_observations) return vectors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>d</strong> (<em>int</em><em>, </em><em>optional</em>) – Embedding dimension. Default is 64</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_pocket_dimension.test_tf_filter">
<span class="sig-prename descclassname"><span class="pre">tests.test_pocket_dimension.</span></span><span class="sig-name descname"><span class="pre">test_tf_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tmp_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tests/test_pocket_dimension.html#test_tf_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tests.test_pocket_dimension.test_tf_filter" title="Link to this definition"></a></dt>
<dd><p>Testing the bloom filter &amp; filter_out parameters for the TFVectorizer</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_pocket_dimension.test_tf_temp">
<span class="sig-prename descclassname"><span class="pre">tests.test_pocket_dimension.</span></span><span class="sig-name descname"><span class="pre">test_tf_temp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tests/test_pocket_dimension.html#test_tf_temp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tests.test_pocket_dimension.test_tf_temp" title="Link to this definition"></a></dt>
<dd><p>Test that changing the temperature used during embedding changes the cosine in an
expected way</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_pocket_dimension.test_tfidf">
<span class="sig-prename descclassname"><span class="pre">tests.test_pocket_dimension.</span></span><span class="sig-name descname"><span class="pre">test_tfidf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tmp_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tests/test_pocket_dimension.html#test_tfidf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tests.test_pocket_dimension.test_tfidf" title="Link to this definition"></a></dt>
<dd><p>Test that a tfidf vectorization causes one feature’s tfidf to be zero and match
a vector that does not have this feature</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tests.test_pocket_dimension.test_tfidf_data_quality">
<span class="sig-prename descclassname"><span class="pre">tests.test_pocket_dimension.</span></span><span class="sig-name descname"><span class="pre">test_tfidf_data_quality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tmp_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tests/test_pocket_dimension.html#test_tfidf_data_quality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tests.test_pocket_dimension.test_tfidf_data_quality" title="Link to this definition"></a></dt>
<dd><p>Test that records without minimium data quality (min_n_features &amp;
min_n_observations) return vectors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tmp_path</strong> (<em>str</em>) – Local temp directory to save count-min sketch to</p></li>
<li><p><strong>d</strong> (<em>int</em><em>, </em><em>optional</em>) – Embedding dimension. Default is 64</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pocket_dimension.html" class="btn btn-neutral float-left" title="Pocket Dimension" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="license.html" class="btn btn-neutral float-right" title="License" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Matthew Hendrey and Brendan Murphy.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>